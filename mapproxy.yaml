# (C) 2013 Paul Norman, MIT license

# Include grids, parts, other common config
base: [grids.yaml,globals.yaml]

services:
  demo:
  tms:
    # origin for /tiles service
    origin: 'nw'

layers:
  - name: kelowna_overlay
    title: City of Kelowna roads overlay
    sources: [kelowna_overlay]
  - name: kelowna2012
    title: City of Kelowna 2012 orthos
    sources: [kelowna2012]
  - name: surrey2010
    title: City of Surrey
    sources: [surrey2010]
  - name: surrey2013
    title: City of Surrey
    sources: [surrey2013]

caches:
  kelowna_overlay:
    grids: [z20]
    sources: [kelowna_overlay]
  kelowna2012:
    grids: [z20]
    sources: [kelowna2012]
  surrey2010:
    grids: [z20]
    sources: [surrey2010]
  surrey2013:
    grids: [z20]
    sources: [surrey2013]

parts:
  sources:
    base: &imagery
      type: mapserver
      supported_srs: ['EPSG:3857']
      concurrent_requests: 4

sources:
  seed_only:
    type: debug
    seed_only: true
  kelowna_overlay:
    type: mapnik
    format: png8
    mapfile: '/srv/roads/kelowna/overlay.xml'
    supported_srs: ['EPSG:3857']
    concurrent_requests: 4
    coverage:
      datasource: './kelowna2012.wkt'
      srs: 'EPSG:4326'
  kelowna2012:
    <<: *imagery
    coverage:
      datasource: './kelowna2012.wkt'
      srs: 'EPSG:4326'
    req:
      layers: kelowna2012
      map: './mapfile.map'

  surrey2010:
    <<: *imagery
    coverage:
      datasource: './surrey2010.wkt'
      srs: 'EPSG:4326'
    req:
      layers: surrey2010
      map: './mapfile.map'
  surrey2013:
    <<: *imagery
    coverage:
      datasource: './surrey2013.wkt'
      srs: 'EPSG:4326'
    req:
      layers: surrey2013
      map: './mapfile.map'
